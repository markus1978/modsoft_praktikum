/*
 * generated by Xtext
 */
package de.hub.modsoft.twittersearch.xtext.validation

import de.hub.modsoft.twittersearch.model.Condition
import de.hub.modsoft.twittersearch.model.Search
import de.hub.modsoft.twittersearch.model.TwitterSearchPackage
import org.eclipse.xtext.validation.Check

class TwitterSearchValidator extends AbstractTwitterSearchValidator {
	
	@Check(FAST)
    def checkConditionFieldPartOfSearchType(Condition condition) {
        val search = condition.eContainer as Search
        if (!search.searchType.fields.contains(condition.fieldDeclaration)) {
        	error(
				'''«condition.fieldDeclaration.name» is not a field of the requested search type «search.searchType.name»''', 
				TwitterSearchPackage.eINSTANCE.condition_FieldDeclaration
			);
        }		
    }

	@Check(FAST)
	def checkConditionTypeMatchesFieldType(Condition condition) {
		if (!condition.eClass.name.toLowerCase.startsWith(condition.fieldDeclaration.type.getName.toLowerCase)) {
			error(
				'''«condition.fieldDeclaration.name» has the wrong type.''', 
				TwitterSearchPackage.eINSTANCE.condition_FieldDeclaration
			);
		}
	}

}
